<!DOCTYPE html>
<html lang="en">

<head>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.11.11/lib/p5.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.11.11/lib/addons/p5.sound.min.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css?v=10">
  <meta charset="utf-8" />

</head>

<body>
  <div id="container">
    <div id="sketch-pane" class="pane-collapsed">
      <main></main>
      <button id="pane-toggle" title="Toggle side panel (H)">
        <kbd class="key-badge" data-key="h">H</kbd>
        <svg width="10" height="16" viewBox="0 0 10 16" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round">
          <polyline points="2,2 8,8 2,14" />
        </svg>
      </button>
    </div>
    <div id="search-pane">
      <div id="tab-bar">
        <button class="tab-btn tab-active" data-tab="introduction">
          <span class="tab-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"
              stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 11V6a2 2 0 0 0-4 0" />
              <path d="M14 10V4a2 2 0 0 0-4 0v6" />
              <path d="M10 10.5V6a2 2 0 0 0-4 0v8" />
              <path d="M18 8a2 2 0 0 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.9-6.1-2.7L3.2 16a2 2 0 0 1 3-2.5L8 15.5" />
              <path d="M2 2l3 2.5M1 6l2 .5" />
            </svg></span>
          Introduction
          <kbd class="key-badge" data-key="i">I</kbd>
        </button>
        <button class="tab-btn" data-tab="match-search">
          <span class="tab-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="7" />
              <line x1="16.5" y1="16.5" x2="21" y2="21" />
            </svg></span>
          Match Search
          <kbd class="key-badge" data-key="m">M</kbd>
        </button>
        <button class="tab-btn" data-tab="customisation">
          <span class="tab-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <path
                d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.9 0 1.5-.7 1.5-1.5 0-.4-.1-.7-.4-1-.2-.3-.4-.6-.4-1 0-.8.7-1.5 1.5-1.5H16c3.3 0 6-2.7 6-6 0-5-4.5-9-10-9z" />
              <circle cx="7.5" cy="11.5" r="1.5" fill="currentColor" />
              <circle cx="10.5" cy="7.5" r="1.5" fill="currentColor" />
              <circle cx="14.5" cy="7.5" r="1.5" fill="currentColor" />
              <circle cx="17.5" cy="11.5" r="1.5" fill="currentColor" />
            </svg></span>
          Customisation
          <kbd class="key-badge" data-key="c">C</kbd>
        </button>
        <button class="tab-btn" data-tab="share">
          <span class="tab-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round">
              <circle cx="18" cy="5" r="3" />
              <circle cx="6" cy="12" r="3" />
              <circle cx="18" cy="19" r="3" />
              <line x1="8.6" y1="13.5" x2="15.4" y2="17.5" />
              <line x1="15.4" y1="6.5" x2="8.6" y2="10.5" />
            </svg></span>
          Share
          <kbd class="key-badge" data-key="s">S</kbd>
        </button>
        <button id="tab-bar-fullscreen" title="Fullscreen (F)">
          <kbd class="key-badge" data-key="f" id="fullscreen-key-badge">F</kbd>
          <span class="text">Fullscreen</span>
        </button>
      </div>
      <div id="tab-content">
        <div class="tab-panel tab-panel-active" id="tab-introduction">
          <div class="tab-panel-inner">
            <h2>Welcome</h2>
            <p class="tab-placeholder-text">Introduction content coming soon.</p>
          </div>
        </div>
        <div class="tab-panel" id="tab-match-search">
          <div id="search-container">
            <div id="top-controls">
              <div id="random-match-section">
                <button id="random-match-btn">
                  <kbd class="key-badge" data-key="r">R</kbd>
                  <span class="text">Load random match</span>
                </button>
              </div>
            </div>
            <div id="search-stack">
              <div id="current-match">
                <h3>Selected Match:</h3>
                <p id="match-display"></p>
              </div>
              <div id="search-scroll">
                <div id="search-labels">
                  <div class="search-label">Year</div>
                  <div class="search-label-with-round">
                    <span class="search-label">Tournament</span>
                    <div id="gender-selector">
                      <button class="gender-btn gender-selected" data-gender="" title="All genders">All</button>
                      <button class="gender-btn" data-gender="W" title="Women's">W</button>
                      <button class="gender-btn" data-gender="M" title="Men's">M</button>
                    </div>
                    <div id="round-selector">
                      <span class="round-label">Round:</span>
                      <button class="round-btn round-in-range" data-round="Q1" title="Qualifiers">Q</button>
                      <button class="round-btn round-in-range" data-round="R128"
                        title="First round (Round of 128)">1<sup>st</sup></button>
                      <button class="round-btn round-in-range" data-round="R64"
                        title="Second round (Round of 64)">2<sup>nd</sup></button>
                      <button class="round-btn round-in-range" data-round="R32"
                        title="Third round (Round of 32)">3<sup>rd</sup></button>
                      <button class="round-btn round-in-range" data-round="R16"
                        title="Fourth round (Round of 16)">4<sup>th</sup></button>
                      <button class="round-btn round-in-range" data-round="QF"
                        title="Quarterfinals (includes Round Robin)">QF</button>
                      <button class="round-btn round-in-range" data-round="SF"
                        title="Semifinals (includes Bronze Medal)">SF</button>
                      <button class="round-btn round-in-range" data-round="F" title="Final">F</button>
                    </div>
                    <span class="search-label players-label">Players</span>
                  </div>
                </div>
                <div id="search-fields">
                  <div id="date-container" class="field-badge-container">
                    <input type="text" id="search-date-year" maxlength="4" autocomplete="off" placeholder=" ">
                    <kbd class="key-badge field-key-badge" data-key="y">Y</kbd>
                  </div>
                  <div class="field-badge-container">
                    <input type="text" id="search-tournament" autocomplete="off" placeholder=" ">
                    <kbd class="key-badge field-key-badge" data-key="t">T</kbd>
                  </div>
                  <div class="player-field-wrapper" id="player-fields">
                    <input type="text" id="search-player1" autocomplete="off" placeholder=" ">
                    <span class="player-sep"> vs </span>
                    <input type="text" id="search-player2" autocomplete="off" class="player-field-hidden"
                      placeholder=" ">
                    <kbd class="key-badge field-key-badge" data-key="p">P</kbd>
                  </div>
                </div>
              </div>
              <div id="match-count-bar" class="match-count-hidden">
                <span id="match-count-text"></span>
              </div>
              <div id="loading-indicator" class="loading-hidden">
                <div id="progress-text">Loading match database...</div>
                <div id="progress-bar-container">
                  <div id="progress-bar"></div>
                </div>
              </div>
              <div id="dropdown" class="dropdown-hidden"></div>
            </div>
          </div>
        </div>
        <div class="tab-panel" id="tab-customisation">
          <div class="tab-panel-inner">
            <h2>Customisation</h2>
            <div id="color-picker-section">
              <h3>Player Colors</h3>
              <div id="color-ring-wrap">
                <div id="lab-toggle-bar" class="lab-toggle-hidden">
                  <div class="lab-toggle-row">
                    <button class="lab-toggle-btn lab-cycle-btn active" data-toggle="gamut"
                      title="Cycle gamut: silhouette → edges → wireframe → opaque">Gamut: Silhouette</button>
                    <button class="lab-toggle-btn active" data-toggle="surface"
                      title="Show Pareto surface">Surface</button>
                    <button class="lab-toggle-btn active" data-toggle="frontier"
                      title="Chromaticity frontier">Frontier</button>
                    <button class="lab-toggle-btn active" data-toggle="dark" title="Dark variants">Dark</button>
                    <button class="lab-toggle-btn" data-toggle="ideal" title="Ideal complement curves">Ideal</button>
                    <button class="lab-toggle-btn" data-toggle="closest"
                      title="Closest-to-ideal curves">Closest</button>
                  </div>
                  <div class="lab-toggle-row">
                    <button class="lab-toggle-btn" data-toggle="maxchroma" title="Max chroma ring at P1's lightness">Max
                      C ring</button>
                    <button class="lab-toggle-btn" data-toggle="constchroma"
                      title="Constant chroma circle at P1's chroma">Const C ring</button>
                  </div>
                </div>
                <canvas id="color-ring-canvas" width="500" height="500"></canvas>
              </div>
              <div id="lab-pareto-sliders" class="lab-toggle-hidden">
                <div class="pareto-slider-row">
                  <label title="Max lightness deviation from ideal">ΔL</label>
                  <input type="range" class="pareto-slider" data-axis="L" min="0" max="100" value="100">
                  <span class="pareto-val" data-axis="L">1.00</span>
                </div>
                <div class="pareto-slider-row">
                  <label title="Max chroma deficit from ideal">ΔC</label>
                  <input type="range" class="pareto-slider" data-axis="C" min="0" max="100" value="100">
                  <span class="pareto-val" data-axis="C">1.00</span>
                </div>
                <div class="pareto-slider-row">
                  <label title="Max hue deviation from ideal">Δh</label>
                  <input type="range" class="pareto-slider" data-axis="H" min="0" max="180" value="180">
                  <span class="pareto-val" data-axis="H">180°</span>
                </div>
              </div>
              <div id="color-picker-controls">
                <button id="color-lock-btn" class="color-ctrl-btn color-locked" title="Lock colors complementary">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                  </svg>
                  <span>Locked</span>
                </button>
                <button id="color-swap-btn" class="color-ctrl-btn" title="Swap player colors">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="17 1 21 5 17 9" />
                    <path d="M3 11V9a4 4 0 0 1 4-4h14" />
                    <polyline points="7 23 3 19 7 15" />
                    <path d="M21 13v2a4 4 0 0 1-4 4H3" />
                  </svg>
                  <span>Swap</span>
                </button>
                <button id="color-sacrifice-btn" class="color-ctrl-btn sacrifice-hidden" title="Toggle sacrifice mode">
                  <span>Chroma only</span>
                </button>
                <button id="color-animate-btn" class="color-ctrl-btn sacrifice-hidden"
                  title="Animate Pareto surface derivation">
                  <span>Animate</span>
                </button>
                <div id="color-shape-toggle" class="shape-toggle shape-lab" title="Toggle display mode">
                  <span class="shape-toggle-label shape-label-gamut">Gamut</span>
                  <span class="shape-toggle-label shape-label-circle">Circle</span>
                  <span class="shape-toggle-label shape-label-strip">Strip</span>
                  <span class="shape-toggle-label shape-label-lab">Lab</span>
                </div>
              </div>
              <div id="color-swatches">
                <div class="color-swatch-row">
                  <span class="swatch-label">Player 1</span>
                  <span class="swatch-chip" id="swatch-p1-bright"></span>
                  <span class="swatch-chip swatch-dark" id="swatch-p1-dark"></span>
                </div>
                <div class="color-swatch-row">
                  <span class="swatch-label">Player 2</span>
                  <span class="swatch-chip" id="swatch-p2-bright"></span>
                  <span class="swatch-chip swatch-dark" id="swatch-p2-dark"></span>
                </div>
              </div>
            </div>

            <!-- Theme controls -->
            <div id="theme-section">
              <h3>Theme</h3>
              <div id="theme-controls">
                <button id="theme-lightdark-btn" class="color-ctrl-btn" title="Toggle light/dark mode">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5" />
                    <line x1="12" y1="1" x2="12" y2="3" />
                    <line x1="12" y1="21" x2="12" y2="23" />
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                    <line x1="1" y1="12" x2="3" y2="12" />
                    <line x1="21" y1="12" x2="23" y2="12" />
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                  </svg>
                  <span>Dark</span>
                </button>
                <div id="theme-temp-controls">
                  <button class="theme-temp-btn" data-temp="warm" title="Warm tones">Warm</button>
                  <button class="theme-temp-btn theme-temp-active" data-temp="neutral"
                    title="Neutral tones">Neutral</button>
                  <button class="theme-temp-btn" data-temp="cool" title="Cool tones">Cool</button>
                </div>
              </div>
            </div>

            <!-- Accent color picker -->
            <div id="accent-section">
              <h3>Accent Colour</h3>
              <div id="accent-viewport-wrap">
                <canvas id="accent-viewport-canvas"></canvas>
              </div>
              <div id="accent-bg-swatch">
                <span id="accent-bg-label">Background</span>
                <span id="accent-bg-chip"></span>
              </div>
              <div id="accent-bg-swatch" style="margin-top:2px;">
                <span id="accent-bg-label">Foreground</span>
                <span id="accent-fg-chip"></span>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-panel" id="tab-share">
          <div class="tab-panel-inner">
            <h2>Share</h2>
            <p class="tab-placeholder-text">Sharing options coming soon.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Custom tooltip -->
  <div id="custom-tooltip" class="custom-tooltip hidden"></div>
  <script src="rallyParser.js?v=4"></script>
  <script src="matchData.js?v=4"></script>
  <script src="searchPane.js?v=4"></script>
  <script src="sketch.js?v=10"></script>
</body>

</html>